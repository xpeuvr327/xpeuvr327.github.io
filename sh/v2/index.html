<!DOCTYPE html><html lang="en"><head<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>URL Shortener</title></head><body><h1>URL Shortener</h1><p id="nahh">Redirecting... or is it?</p><a id="downloadLink" style="display:none;">Download Updated JSON</a><script>function getQueryParams(){return new URLSearchParams(window.location.search)}async function redirectUser(){const params=getQueryParams(),route=params.get('r'),b64=params.get('b64'),canPass=params.has('p');if(route){try{const response=await fetch('p/redirects.json'),data=await response.json(),redirectEntry=data.find(entry=>entry.sh===route);if(redirectEntry){window.location.href=redirectEntry.url}else{alert('Route not found')}}catch(error){console.error('Error fetching redirects.json:',error),alert('Error fetching redirects.json')}}else if(b64){try{const decodedUrl=atob(b64);canPass||confirm(`Are you sure you want to be redirected to ${decodedUrl}?`)&&(window.location.href=decodedUrl)}catch(error){alert('Invalid base64 URL')}}else{displayRoutes(),displayUrlForm(),document.getElementById('nahh').textContent=''}}async function displayRoutes(){try{const response=await fetch('p/redirects.json'),data=await response.json();let routesHtml='<h2>Available Routes</h2><ul>';data.filter(entry=>!entry.hide).forEach(entry=>{routesHtml+=`<li><code>?r=${entry.sh}</code> -> <a href="${entry.url}">${entry.url}</a></li>`});routesHtml+='</ul>',document.body.innerHTML+=routesHtml,document.body.innerHTML+=` <h2>Base64 URL Encoder/Decoder</h2> <input type="text" id="base64" placeholder="Base64 URL"> <input type="text" id="clearText" placeholder="Clear Text URL"> <button onclick="convertBase64()">Convert</button> `}catch(error){console.error('Error fetching redirects.json:',error),alert('Error fetching redirects.json')}}function convertBase64(){const base64Input=document.getElementById('base64').value,clearTextInput=document.getElementById('clearText').value;base64Input?document.getElementById('clearText').value=atob(base64Input):clearTextInput&&(document.getElementById('base64').value=btoa(clearTextInput))}function generateUniqueCode(existingCodes){const characters='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';let code;do{code='';for(let i=0;i<3;i++)code+=characters.charAt(Math.floor(Math.random()*characters.length))}while(existingCodes.includes(code));return code}async function shortenUrl(){const urlInput=document.getElementById('urlInput').value,hideInput=document.getElementById('hideInput').checked;if(!urlInput){alert('Please enter a URL');return}try{const response=await fetch('p/redirects.json'),data=await response.json(),existingUrl=data.find(entry=>entry.url===urlInput);if(existingUrl){alert(`URL already exists. Short URL: ?r=${existingUrl.sh}`);return}const existingCodes=data.map(entry=>entry.sh),newCode=generateUniqueCode(existingCodes),newEntry={sh:newCode,url:urlInput};hideInput&&(newEntry.hide=!0),data.push(newEntry);const jsonString=JSON.stringify(data),blob=new Blob([jsonString],{type:'application/json'}),url=URL.createObjectURL(blob),downloadLink=document.getElementById('downloadLink');downloadLink.href=url,downloadLink.setAttribute('download','redirects.json'),downloadLink.style.display='block',downloadLink.textContent=`Download Updated JSON`,alert(`Shortened URL: ?r=${newCode}`)}catch(error){console.error('Error fetching or updating redirects.json:',error),alert('Error fetching or updating redirects.json')}}function displayUrlForm(){const formHtml=`<div id="urlForm"><label for="urlInput">Enter URL:</label><input type="text" id="urlInput" placeholder="https://example.com"><label for="hideInput">Hide:</label><input type="checkbox" id="hideInput"><button type="button" onclick="shortenUrl()">Shorten</button></div>`;document.body.innerHTML+=formHtml}window.onload=redirectUser;</script></body></html>